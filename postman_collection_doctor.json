{
  "info": {
    "name": "HaiAnhTeeth - Doctor APIs",
    "description": "API collection for Doctor endpoints - Lịch khám, chi tiết ca khám, thông tin bệnh nhân",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000/api",
      "type": "string"
    },
    {
      "key": "doctorToken",
      "value": "your_doctor_jwt_token_here",
      "type": "string"
    },
    {
      "key": "appointmentId",
      "value": "appointment_id_from_db",
      "type": "string"
    },
    {
      "key": "patientId",
      "value": "patient_id_from_db",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "1. Doctor Login (Lấy Token)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"doctor@example.com\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}/auth/login"]
            },
            "description": "Đăng nhập bằng tài khoản Doctor để lấy JWT token\n\nResponse sẽ trả về token, copy token này vào biến {{doctorToken}}"
          }
        }
      ]
    },
    {
      "name": "Doctor - Danh sách lịch khám (2 tuần)",
      "item": [
        {
          "name": "Lấy danh sách lịch hẹn (Tuần hiện tại + tuần tiếp theo)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{doctorToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/doctor/appointments-schedule",
              "host": ["{{baseUrl}}/doctor/appointments-schedule"]
            },
            "description": "✅ Lấy danh sách tất cả ca khám của doctor trong 2 tuần\n\nResponse: Nhóm lịch theo ngày, có thông tin chi tiết\n- doctorName\n- periodStart & periodEnd\n- appointmentsByDay (object - key là ngày)\n- totalAppointments"
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{doctorToken}}"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/doctor/appointments-schedule",
                  "host": ["{{baseUrl}}/doctor/appointments-schedule"]
                }
              },
              "status": "OK",
              "code": 200,
              "header": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Lấy lịch khám thành công\",\n  \"data\": {\n    \"doctorName\": \"Nguyễn Văn A\",\n    \"doctorId\": \"xxx\",\n    \"periodStart\": \"2025-10-20\",\n    \"periodEnd\": \"2025-11-03\",\n    \"appointmentsByDay\": {\n      \"2025-10-20\": [\n        {\n          \"appointmentId\": \"xxx\",\n          \"type\": \"Consultation\",\n          \"status\": \"Approved\",\n          \"startTime\": \"2025-10-20T09:00:00Z\",\n          \"endTime\": \"2025-10-20T10:00:00Z\",\n          \"patient\": {\n            \"fullName\": \"Trần Thị B\",\n            \"email\": \"patient@example.com\",\n            \"phoneNumber\": \"0123456789\"\n          },\n          \"service\": {\n            \"serviceName\": \"Tư vấn\",\n            \"price\": 200000\n          },\n          \"notes\": \"Bệnh nhân khám lần đầu\",\n          \"mode\": \"Online\",\n          \"linkMeetUrl\": \"https://zoom.us/...\"\n        }\n      ]\n    },\n    \"totalAppointments\": 12\n  }\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Doctor - Chi tiết Ca khám (Pop-up 1)",
      "item": [
        {
          "name": "Lấy chi tiết một ca khám",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{doctorToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/doctor/appointments/{{appointmentId}}",
              "host": ["{{baseUrl}}/doctor/appointments/{{appointmentId}}"]
            },
            "description": "✅ Hiển thị Pop-up chi tiết ca khám\n\nCách sử dụng:\n1. Từ danh sách lịch hẹn, lấy appointmentId\n2. Set appointmentId vào biến {{appointmentId}}\n3. Gọi endpoint này\n\nResponse: Toàn bộ chi tiết ca khám"
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{doctorToken}}"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/doctor/appointments/xxx",
                  "host": ["{{baseUrl}}/doctor/appointments/xxx"]
                }
              },
              "status": "OK",
              "code": 200,
              "header": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Lấy chi tiết lịch hẹn thành công\",\n  \"data\": {\n    \"appointmentId\": \"xxx\",\n    \"type\": \"Examination\",\n    \"status\": \"CheckedIn\",\n    \"mode\": \"Offline\",\n    \"patient\": {\n      \"_id\": \"yyy\",\n      \"fullName\": \"Trần Thị B\",\n      \"email\": \"patient@example.com\",\n      \"phoneNumber\": \"0123456789\",\n      \"dob\": \"1990-01-01\",\n      \"gender\": \"Female\",\n      \"address\": \"123 Nguyễn Huệ, TP.HCM\"\n    },\n    \"service\": {\n      \"_id\": \"zzz\",\n      \"serviceName\": \"Khám tổng quát\",\n      \"price\": 500000,\n      \"description\": \"Khám toàn bộ cơ thể\"\n    },\n    \"timeslot\": {\n      \"_id\": \"www\",\n      \"startTime\": \"2025-10-20T09:00:00Z\",\n      \"endTime\": \"2025-10-20T10:00:00Z\"\n    },\n    \"payment\": {\n      \"_id\": \"ppp\",\n      \"status\": \"Completed\",\n      \"amount\": 500000,\n      \"method\": \"Sepay\"\n    },\n    \"notes\": \"Bệnh nhân có dị ứng với Amoxicillin\",\n    \"linkMeetUrl\": \"https://zoom.us/j/xxx\",\n    \"rescheduleCount\": 1,\n    \"replacedDoctorUserId\": null,\n    \"createdAt\": \"2025-10-18T10:30:00Z\",\n    \"updatedAt\": \"2025-10-20T08:45:00Z\"\n  }\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Doctor - Thông tin Bệnh nhân (Pop-up 2)",
      "item": [
        {
          "name": "Lấy chi tiết thông tin bệnh nhân",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{doctorToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/doctor/patients/{{patientId}}",
              "host": ["{{baseUrl}}/doctor/patients/{{patientId}}"]
            },
            "description": "✅ Hiển thị Pop-up thông tin bệnh nhân + lịch sử khám\n\nCách sử dụng:\n1. Từ chi tiết ca khám, lấy patient._id\n2. Set patientId vào biến {{patientId}}\n3. Gọi endpoint này\n\nResponse: \n- Thông tin cá nhân\n- Lịch sử khám (đã hoàn tất)\n- Lịch sắp tới"
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{doctorToken}}"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/doctor/patients/xxx",
                  "host": ["{{baseUrl}}/doctor/patients/xxx"]
                }
              },
              "status": "OK",
              "code": 200,
              "header": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Lấy chi tiết thông tin bệnh nhân thành công\",\n  \"data\": {\n    \"patientId\": \"xxx\",\n    \"fullName\": \"Trần Thị B\",\n    \"email\": \"patient@example.com\",\n    \"phoneNumber\": \"0123456789\",\n    \"dateOfBirth\": \"1990-01-01\",\n    \"gender\": \"Female\",\n    \"address\": \"123 Nguyễn Huệ, TP.HCM\",\n    \"status\": \"Active\",\n    \"appointmentHistory\": {\n      \"total\": 5,\n      \"list\": [\n        {\n          \"_id\": \"aaa\",\n          \"type\": \"Examination\",\n          \"status\": \"Completed\",\n          \"notes\": \"Khám xong, bệnh nhân bình thường\",\n          \"service\": {\n            \"_id\": \"zzz\",\n            \"serviceName\": \"Khám tổng quát\",\n            \"price\": 500000\n          },\n          \"timeslot\": {\n            \"_id\": \"www\",\n            \"startTime\": \"2025-09-15T09:00:00Z\",\n            \"endTime\": \"2025-09-15T10:00:00Z\"\n          },\n          \"createdAt\": \"2025-09-15T10:30:00Z\"\n        }\n      ]\n    },\n    \"upcomingAppointments\": {\n      \"total\": 2,\n      \"list\": [\n        {\n          \"_id\": \"bbb\",\n          \"type\": \"Consultation\",\n          \"status\": \"Approved\",\n          \"service\": {\n            \"_id\": \"ccc\",\n            \"serviceName\": \"Tư vấn\"\n          },\n          \"timeslot\": {\n            \"_id\": \"ddd\",\n            \"startTime\": \"2025-10-22T14:00:00Z\",\n            \"endTime\": \"2025-10-22T15:00:00Z\"\n          }\n        }\n      ]\n    }\n  }\n}"
            }
          ]
        }
      ]
    }
  ]
}
